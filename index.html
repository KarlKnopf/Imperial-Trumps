<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Imperial Trumps</title>
<style>
/* -------------------- */
/* GENERAL STYLING      */
/* -------------------- */
body {
    font-family: sans-serif;
    background-color: #2a2a2a;
    color: #fff;
    margin: 0;
    padding: 0;
}

#game-area {
    display: flex;
    gap: 30px;
    padding: 20px;
}

/* -------------------- */
/* STOCK                */
/* -------------------- */
#stock {
    width: 120px;
    height: 180px;
    border: 2px dashed #ccc;
    position: relative;
}

/* -------------------- */
/* TABLEAU              */
/* -------------------- */
#tableau {
    display: flex;
    gap: 15px;
}

.tableau-pile {
    width: 120px;
    min-height: 180px;
    border: 2px dashed #aaa;
    padding: 5px;
    position: relative;
}

/* -------------------- */
/* FOUNDATIONS          */
/* -------------------- */
#foundations {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.foundation {
    width: 120px;
    min-height: 180px;
    border: 2px dashed #f1c40f;
    text-align: center;
    padding-top: 5px;
    position: relative;
}

/* -------------------- */
/* CARDS                */
/* -------------------- */
.card {
    width: 100%;
    height: auto;
    cursor: pointer;
    user-select: none;
    position: absolute;
    top: 0;
    left: 0;
}

.card.dragging {
    opacity: 0.7;
}

.card:hover {
    transform: scale(1.05);
    transition: transform 0.2s;
}
</style>
</head>
<body>

<h1 style="text-align:center;">Imperial Trumps</h1>
<div id="game-area">
    <div id="stock"></div>
    <div id="tableau"></div>
    <div id="foundations"></div>
</div>

<script>
// --------------------
// CONFIG & DECK SETUP
// --------------------
const backImg = "images/back/card78.png"; // path to your back image

let deck = [];

// Build deck
function buildDeck() {
    // Major Arcana 0-21
    for (let i = 0; i <= 21; i++) deck.push({ type: "major", rank: i+1, img: `images/major/card${i}.png` });
    // Keys 22-35
    for (let i = 22; i <= 35; i++) deck.push({ type: "keys", rank: i-21, img: `images/keys/card${i}.png` });
    // Cups 36-49
    for (let i = 36; i <= 49; i++) deck.push({ type: "cups", rank: i-35, img: `images/cups/card${i}.png` });
    // Swords 50-63
    for (let i = 50; i <= 63; i++) deck.push({ type: "swords", rank: i-49, img: `images/swords/card${i}.png` });
    // Pentacles 64-77
    for (let i = 64; i <= 77; i++) deck.push({ type: "pentacles", rank: i-63, img: `images/pentacles/card${i}.png` });
}

// Shuffle function
function shuffle(array) {
    for (let i=array.length-1; i>0; i--){
        const j = Math.floor(Math.random()*(i+1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

// --------------------
// ELEMENT REFERENCES
// --------------------
const stockDiv = document.getElementById("stock");
const tableauDiv = document.getElementById("tableau");
const foundationsDiv = document.getElementById("foundations");

// Tableau piles array
const tableauPiles = [];
for (let i=0; i<7; i++) {
    const pile = document.createElement("div");
    pile.classList.add("tableau-pile");
    pile.dataset.index = i;
    tableauDiv.appendChild(pile);
    tableauPiles.push(pile);
}

// Foundation piles
const foundationSuits = ["keys","cups","swords","pentacles","major"];
foundationSuits.forEach(suit=>{
    const f = document.createElement("div");
    f.classList.add("foundation");
    f.dataset.suit = suit;
    f.innerHTML = `<strong>${suit.toUpperCase()}</strong>`;
    foundationsDiv.appendChild(f);
});

// --------------------
// STOCK & DEAL
// --------------------
let stockStack = [];

function renderStock() {
    stockDiv.innerHTML = "";
    if(stockStack.length === 0) return;
    const topCard = stockStack[stockStack.length-1];
    const img = document.createElement("img");
    img.src = backImg;
    img.dataset.front = topCard.img;
    img.dataset.type = topCard.type;
    img.dataset.rank = topCard.rank;
    img.classList.add("card");

    img.addEventListener("click", ()=>{
        img.src = img.src.includes(backImg) ? img.dataset.front : backImg;
    });

    img.draggable = true;
    img.addEventListener("dragstart", e=>{
        img.classList.add("dragging");
        e.dataTransfer.setData("text/plain", JSON.stringify({
            type: img.dataset.type,
            rank: img.dataset.rank,
            src: img.dataset.front
        }));
    });
    img.addEventListener("dragend", ()=> img.classList.remove("dragging"));

    stockDiv.appendChild(img);
}

// Deal tableau (simplified)
function dealTableau() {
    for(let i=0; i<7; i++){
        for(let j=0;j<=i;j++){
            const card = stockStack.pop();
            const img = document.createElement("img");
            img.src = card.img;
            img.dataset.type = card.type;
            img.dataset.rank = card.rank;
            img.classList.add("card");
            img.style.top = `${j*30}px`;
            img.draggable = true;
            img.addEventListener("dragstart", e=>{
                img.classList.add("dragging");
                e.dataTransfer.setData("text/plain", JSON.stringify({
                    type: img.dataset.type,
                    rank: img.dataset.rank,
                    src: img.src
                }));
            });
            img.addEventListener("dragend", ()=> img.classList.remove("dragging"));
            tableauPiles[i].appendChild(img);
        }
    }
}

// --------------------
// ENABLE DROP
// --------------------
function enableDrop(targetDiv){
    targetDiv.addEventListener("dragover", e=>e.preventDefault());
    targetDiv.addEventListener("drop", e=>{
        e.preventDefault();
        const dragging = document.querySelector(".dragging");
        if(!dragging) return;
        const oldPile = dragging.parentElement;
        targetDiv.appendChild(dragging);
    });
}

tableauPiles.forEach(p=>enableDrop(p));
document.querySelectorAll(".foundation").forEach(f=>enableDrop(f));

// --------------------
// INIT GAME
// --------------------
buildDeck();
deck = shuffle(deck);
stockStack = [...deck];
renderStock();
dealTableau();

</script>
</body>
</html>
